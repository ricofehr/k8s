---

- name: Ensure helm-values folder is present
  file:
    path: helm-values
    state: directory
    mode: 0755

- name: Values parameters file
  template:
    src: templates/values.yml.j2
    dest: helm-values/dashboard.yml

- name: add helm repo for dashboard
  shell: helm repo add k8s-dashboard https://kubernetes.github.io/dashboard

- name: launch dashboard
  shell: helm install dashboard --namespace kube-system -f helm-values/dashboard.yml k8s-dashboard/kubernetes-dashboard --version 3.0.2

- name: url dashboard
  debug:
    msg: "You can reach the dashboard with http://{{ ansible_host }}:8001/api/v1/namespaces/kube-system/services/http:dashboard-kubernetes-dashboard:http/proxy/"
  when: is_cloud == '0'
